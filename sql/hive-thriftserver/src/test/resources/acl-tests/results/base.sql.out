-- Automatically generated by ThriftEndToEndAclTestSuite
-- Number of queries: 12


-- !query 0
create database db1
-- !query 0 token
super
-- !query 0 schema
struct<Result:string>
-- !query 0 output



-- !query 1
create view db1.vw1 as select * from range(10)
-- !query 1 token
super
-- !query 1 schema
struct<Result:string>
-- !query 1 output



-- !query 2
select * from db1.vw1
-- !query 2 token
super
-- !query 2 schema
struct<id:bigint>
-- !query 2 output
[0]
[1]
[2]
[3]
[4]
[5]
[6]
[7]
[8]
[9]


-- !query 3
select * from db1.vw1
-- !query 3 token
usr1
-- !query 3 schema
struct<>
-- !query 3 output
java.lang.SecurityException: Principal is not authorized to execute the given query


-- !query 4
grant select on db1.vw1 to usr1
-- !query 4 token
super
-- !query 4 schema
struct<Result:string>
-- !query 4 output



-- !query 5
grant read_metadata on database db1 to usr1
-- !query 5 token
super
-- !query 5 schema
struct<Result:string>
-- !query 5 output



-- !query 6
show grant usr1 on db1.vw1
-- !query 6 token
usr1
-- !query 6 schema
struct<Principal:string,ActionType:string,ObjectType:string,ObjectKey:string>
-- !query 6 output
[usr1, SELECT, TABLE, `db1`.`vw1`]


-- !query 7
show tables in db1
-- !query 7 token
usr1
-- !query 7 schema
struct<database:string,tableName:string,isTemporary:boolean>
-- !query 7 output
[db1, vw1, false]


-- !query 8
select * from db1.vw1
-- !query 8 token
usr1
-- !query 8 schema
struct<id:bigint>
-- !query 8 output
[0]
[1]
[2]
[3]
[4]
[5]
[6]
[7]
[8]
[9]


-- !query 9
drop database db1 cascade
-- !query 9 token
super
-- !query 9 schema
struct<Result:string>
-- !query 9 output



-- !query 10
show databases
-- !query 10 token
super
-- !query 10 schema
struct<databaseName:string>
-- !query 10 output
[default]


-- !query 11
msck repair database __all__ privileges
-- !query 11 token
super
-- !query 11 schema
struct<Result:string>
-- !query 11 output

